"use strict";function formBuilderHelpersFn(opts,formBuilder){var _helpers={doCancel:!1},utils=fbUtils;return formBuilder.events=formBuilderEventsFn(),_helpers.makeClassName=function(e){return e=e.replace(/[^\w\s\-]/gi,""),utils.hyphenCase(e)},_helpers.mobileClass=function(){var e="";return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=" fb-mobile")}(navigator.userAgent||navigator.vendor||window.opera),e},_helpers.startMoving=function(e,t){t.item.show().addClass("moving"),_helpers.startIndex=$("li",this).index(t.item)},_helpers.stopMoving=function(e,t){t.item.removeClass("moving"),_helpers.doCancel&&($(t.sender).sortable("cancel"),$(this).sortable("cancel")),_helpers.save(),_helpers.doCancel=!1},_helpers.beforeStop=function(e,t){var a=document.getElementById(opts.formID),s=a.children.length-1,r=[];_helpers.stopIndex=t.placeholder.index()-1,!opts.sortableControls&&t.item.parent().hasClass("frmb-control")&&r.push(!0),opts.prepend&&r.push(0===_helpers.stopIndex),opts.append&&r.push(_helpers.stopIndex+1===s),_helpers.doCancel=r.some(function(e){return e===!0})},_helpers.safename=function(e){return e.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()},_helpers.forceNumber=function(e){return e.replace(/[^0-9]/g,"")},_helpers.initTooltip=function(e){var t=e.find(".tooltip");e.mouseenter(function(){t.outerWidth()>200&&t.addClass("max-width"),t.css("left",e.width()+14),t.stop(!0,!0).fadeIn("fast")}).mouseleave(function(){e.find(".tooltip").stop(!0,!0).fadeOut("fast")}),t.hide()},_helpers.getTypes=function(e){var t={type:e.attr("type")},a=$(".fld-subtype",e).val();return a!==t.type&&(t.subtype=a),t},_helpers.fieldOptionData=function(e){var t=[];return $(".sortable-options li",e).each(function(){var e=$(this),a=$(".option-selected",e).is(":checked"),s={label:$(".option-label",e).val(),value:$(".option-value",e).val()};a&&(s.selected=a),t.push(s)}),t},_helpers.xmlSave=function(e){var t=_helpers.prepData(e),a=["<form-template>\n	<fields>"];return utils.forEach(t,function(e,t){var s=null;if(t.type.match(/(select|checkbox-group|radio-group)/)){for(var r=t.values,l=[],n=0;n<r.length;n++){var i=utils.markup("option",r[n].label,r[n]).outerHTML;l.push("\n			"+i)}l.push("\n		"),s=l.join(""),delete t.values}var o=utils.markup("field",s,t);a.push("\n		"+o.outerHTML)}),a.push("\n	</fields>\n</form-template>"),a.join("")},_helpers.prepData=function(e){var t=[];return 0!==e.childNodes.length&&utils.forEach(e.childNodes,function(e,a){var s=$(a);if(!s.hasClass("disabled")){var r,l;!function(){var e=_helpers.getTypes(s),n=$(".roles-field:checked",a).map(function(){return this.value}).get();$('[class*="fld-"]',a).each(function(){var t=utils.camelCase(this.name);e[t]="checkbox"===this.type?this.checked:this.value}),n.length&&(e.role=n.join(",")),e.className=e.className||e.class,r=/(?:^|\s)btn-(.*?)(?:\s|$)/g.exec(e.className),r&&(e.style=r[1]),e=utils.trimObj(e),e=utils.escapeAttrs(e),l=e.type.match(/(select|checkbox-group|radio-group)/),l&&(e.values=_helpers.fieldOptionData(s)),t.push(e)}()}}),t},_helpers.jsonSave=function(e){return window.JSON.stringify(_helpers.prepData(e),null,"	")},_helpers.getData=function(e){var t=e||opts.formData;if(!t)return!1;var a={xml:function(e){return utils.parseXML(e)},json:function(e){return window.JSON.parse(e)}};return formBuilder.formData=a[opts.dataType](t)||[],formBuilder.formData},_helpers.save=function(){var e=document.getElementById(opts.formID),t={xml:_helpers.xmlSave,json:_helpers.jsonSave};return formBuilder.formData=t[opts.dataType](e),document.dispatchEvent(formBuilder.events.formSaved),formBuilder.formData},_helpers.incrementId=function(e){var t=e.lastIndexOf("-"),a=parseInt(e.substring(t+1))+1,s=e.substring(0,t);return s+"-"+a},_helpers.updatePreview=function(field){var fieldClass=field.attr("class");if(-1===fieldClass.indexOf("ui-sortable-handle")){var fieldType=$(field).attr("type"),$prevHolder=$(".prev-holder",field),previewData={type:fieldType},preview;$('[class*="fld-"]',field).each(function(){var e=utils.camelCase(this.name);previewData[e]="checkbox"===this.type?this.checked:this.value});var style=$(".btn-style",field).val();style&&(previewData.style=style),fieldType.match(/(select|checkbox-group|radio-group)/)&&(previewData.values=[],previewData.multiple=$('[name="multiple"]',field).is(":checked"),$(".sortable-options li",field).each(function(){var e={};e.selected=$(".option-selected",this).is(":checked"),e.value=$(".option-value",this).val(),e.label=$(".option-label",this).val(),previewData.values.push(e)})),previewData=utils.trimObj(previewData),previewData.className=_helpers.classNames(field,previewData),$(".fld-className",field).val(previewData.className),field.data("fieldData",previewData),preview=utils.fieldRender(previewData,opts,!0),$prevHolder.html(preview),"file"===previewData.type&&require(["suredyFile"],function(File){File($(".suredy-file",$prevHolder),{fileCount:0,fileType:"",view:previewData.view,changeView:eval(previewData.changeView),addFile:!1,editable:!1,download:!1,autoUpload:!1})}),"date"===previewData.type&&require(["suredyDatetimepicker"],function(Datetimepicker){var $date=$("input[id^=date-]",$prevHolder).addClass("datetimepicker");Datetimepicker($date,{weekstart:parseInt(previewData.weekstart),format:previewData.format||"yyyy-MM-dd",view:previewData.view,manualClose:!!eval(previewData.manualClose)})}),$("input[toggle]",$prevHolder).kcToggle()}},_helpers.debounce=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;return function(){var r=this,l=arguments,n=function(){t=null,s||e.apply(r,l)},i=s&&!t;clearTimeout(t),t=setTimeout(n,a),i&&e.apply(r,l)}},_helpers.disabledTT={className:"frmb-tt",add:function(e){var t=opts.messages.fieldNonEditable;if(t){var a=utils.markup("p",t,{className:_helpers.disabledTT.className});e.append(a)}},remove:function(e){$(".frmb-tt",e).remove()}},_helpers.classNames=function(e,t){var a=void 0,s=t.type,r=t.style,l=e[0].querySelector(".fld-className").value,n=l.split(" "),i={button:"btn",submit:"btn"},o=i[s];if(o){if(r){for(a=0;a<n.length;a++){var p=new RegExp("(?:^|s)"+o+"-(.*?)(?:s|$)+","g"),d=n[a].match(p);d&&n.splice(a,1)}n.push(o+"-"+r)}n.push(o)}return utils.unique(n).join(" ").trim()},_helpers.closeConfirm=function(e,t){e=e||document.getElementsByClassName("form-builder-overlay")[0],t=t||document.getElementsByClassName("form-builder-dialog")[0],e.classList.remove("visible"),t.remove(),e.remove(),document.dispatchEvent(formBuilder.events.modalClosed)},_helpers.editorLayout=function(e){var t={left:{stage:"pull-right",controls:"pull-left"},right:{stage:"pull-left",controls:"pull-right"}};return t[e]?t[e]:""},_helpers.showOverlay=function(){var e=utils.markup("div",null,{className:"form-builder-overlay"});return document.body.appendChild(e),e.classList.add("visible"),e.onclick=function(){_helpers.closeConfirm(e)},e},_helpers.confirm=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=_helpers.showOverlay(),l=utils.markup("button",opts.messages.yes,{className:"yes btn btn-success btn-sm"}),n=utils.markup("button",opts.messages.no,{className:"no btn btn-danger btn-sm"});n.onclick=function(){_helpers.closeConfirm(r)},l.onclick=function(){t(),_helpers.closeConfirm(r)};var i=utils.markup("div",[n,l],{className:"button-wrap"});s="form-builder-dialog "+s;var o=utils.markup("div",[e,i],{className:s});return a?o.classList.add("positioned"):(a={pageX:Math.max(document.documentElement.clientWidth,window.innerWidth||0)/2,pageY:Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2},o.style.position="fixed"),o.style.left=a.pageX+"px",o.style.top=a.pageY+"px",document.body.appendChild(o),l.focus(),o},_helpers.dialog=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_helpers.showOverlay(),a="form-builder-dialog "+a;var s=utils.markup("div",e,{className:a});return t?s.classList.add("positioned"):(t={pageX:Math.max(document.documentElement.clientWidth,window.innerWidth||0)/2,pageY:Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2},s.style.position="fixed"),s.style.left=t.pageX+"px",s.style.top=t.pageY+"px",document.body.appendChild(s),document.dispatchEvent(formBuilder.events.modalOpened),-1!==a.indexOf("data-dialog")&&document.dispatchEvent(formBuilder.events.viewData),s},_helpers.removeAllfields=function(){var e=document.getElementById(opts.formID),t=e.querySelectorAll("li.form-field"),a=$(t),s=[];if(!t.length)return!1;opts.prepend&&s.push(!0),opts.append&&s.push(!0),s.some(function(e){return e===!0})||(e.parentElement.classList.add("empty"),e.parentElement.dataset.content=opts.messages.getStarted),e.classList.add("removing");var r=0;a.each(function(){r+=$(this).outerHeight()+3}),t[0].style.marginTop=-r+"px",setTimeout(function(){a.remove(),document.getElementById(opts.formID).classList.remove("removing"),_helpers.save()},400)},_helpers.setFieldOrder=function(e){if(!opts.sortableControls)return!1;var t={};e.children().each(function(e,a){t[e]=$(a).data("attrs").type}),window.sessionStorage&&window.sessionStorage.setItem("fieldOrder",window.JSON.stringify(t))},_helpers.orderFields=function(e){var t=!1;if(window.sessionStorage&&(opts.sortableControls?t=window.sessionStorage.getItem("fieldOrder"):window.sessionStorage.removeItem("fieldOrder")),t)t=window.JSON.parse(t),t=Object.keys(t).map(function(e){return t[e]});else{var a=opts.controlOrder.concat(e.map(function(e){return e.attrs.type}));t=utils.unique(a)}var s=[];return t.forEach(function(t){var a=e.filter(function(e){return e.attrs.type===t})[0];s.push(a)}),s.filter(Boolean)},_helpers.closeAllEdit=function(e){var t=$("> li.editing",e),a=$(".toggle-form",e),s=$(".frm-holder",t);a.removeClass("open"),t.removeClass("editing"),s.hide(),$(".prev-holder",t).show()},_helpers.toggleEdit=function(e){var t=document.getElementById(e),a=$(".toggle-form",t),s=$(".frm-holder",t);t.classList.toggle("editing"),a.toggleClass("open"),s.slideToggle(250)},_helpers.stickyControls=function(e,t){var a=$(t).parent(),s=e.parent(),r=a.width(),l=t.getBoundingClientRect();$(window).scroll(function(){var e=$(this).scrollTop();if(e>s.offset().top){var n={position:"fixed",width:r,top:0,bottom:"auto",right:"auto",left:l.left},i=a.offset(),o=s.offset(),p=i.top+a.height(),d=o.top+s.height();p>d&&i.top!==o.top&&a.css({position:"absolute",top:"auto",bottom:0,right:0,left:"auto"}),(d>p||p===d&&i.top>e)&&a.css(n)}else t.parentElement.removeAttribute("style")})},_helpers.showData=function(){var e=utils.escapeHtml(formBuilder.formData),t=utils.markup("code",e,{className:"formData-"+opts.dataType}),a=utils.markup("pre",t);_helpers.dialog(a,null,"data-dialog")},_helpers.removeField=function(e){var t=!1,a=document.getElementById(opts.formID),s=a.getElementsByClassName("form-field");if(!s.length)return console.warn("No fields to remove"),!1;if(!e){var r=[].slice.call(s).map(function(e){return e.id});console.warn("fieldID required to use `removeField` action."),console.warn("Available IDs: "+r.join(", "))}var l=document.getElementById(e),n=$(l);return l?(n.slideUp(250,function(){if(n.removeClass("deleting"),n.remove(),t=!0,_helpers.save(),!a.childNodes.length){var e=a.parentElement;e.classList.add("empty"),e.dataset.content=opts.messages.getStarted}}),document.dispatchEvent(formBuilder.events.fieldRemoved),t):(console.warn("Field not found"),!1)},_helpers}function formBuilderEventsFn(){var e={};return e.loaded=new Event("loaded"),e.viewData=new Event("viewData"),e.userDeclined=new Event("userDeclined"),e.modalClosed=new Event("modalClosed"),e.modalOpened=new Event("modalOpened"),e.formSaved=new Event("formSaved"),e.fieldAdded=new Event("fieldAdded"),e.fieldRemoved=new Event("fieldRemoved"),e}"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof Event&&!function(){window.Event=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}}(),"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var a=arguments[t];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fbUtils={};fbUtils.inArray=function(e,t){return-1!==t.indexOf(e)},fbUtils.trimObj=function(e){var t=[null,void 0,"",!1,"false"];for(var a in e)fbUtils.inArray(e[a],t)?delete e[a]:Array.isArray(e[a])&&(e[a].length||delete e[a]);return e},fbUtils.validAttr=function(e){var t=["values","enableOther","other","label","subtype"];return!fbUtils.inArray(e,t)},fbUtils.attrString=function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&fbUtils.validAttr(a)&&(a=fbUtils.safeAttr(a,e[a]),t.push(a.name+a.value));return t.join(" ")},fbUtils.safeAttr=function(e,t){e=fbUtils.safeAttrName(e);var a=void 0;return t&&(Array.isArray(t)?a=fbUtils.escapeAttr(t.join(" ")):("boolean"==typeof t&&(t=t.toString()),a=fbUtils.escapeAttr(t.replace(","," ").trim()))),t=t?'="'+a+'"':"",{name:e,value:t}},fbUtils.safeAttrName=function(e){var t={className:"class"};return t[e]||fbUtils.hyphenCase(e)},fbUtils.hyphenCase=function(e){return e=e.replace(/[^\w\s\-]/gi,""),e=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}),e.replace(/\s/g,"-").replace(/^-+/g,"")},fbUtils.camelCase=function(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})},fbUtils.markup=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=void 0,r=document.createElement(e),l=function(e){return Array.isArray(e)?"array":"undefined"==typeof e?"undefined":_typeof(e)},n={string:function(e){r.innerHTML=e},object:function(e){return r.appendChild(e)},array:function(e){for(var t=0;t<e.length;t++)s=l(e[t]),n[s](e[t])}};for(var i in a)if(a.hasOwnProperty(i)){var o=fbUtils.safeAttrName(i);r.setAttribute(o,a[i])}return s=l(t),t&&n[s].call(this,t),r},fbUtils.parseAttrs=function(e){var t=e.attributes,a={};return fbUtils.forEach(t,function(e){var s=t[e].value;s.match(/false|true/g)?s="true"===s:s.match(/undefined/g)&&(s=void 0),s&&(a[t[e].name]=s)}),a},fbUtils.parseOptions=function(e){var t=e.getElementsByTagName("option"),a={},s=[];if(t.length)for(var r=0;r<t.length;r++)a=fbUtils.parseAttrs(t[r]),a.label=t[r].textContent,s.push(a);return s},fbUtils.parseXML=function(e){var t=new window.DOMParser,a=t.parseFromString(e,"text/xml"),s=[];if(a)for(var r=a.getElementsByTagName("field"),l=0;l<r.length;l++){var n=fbUtils.parseAttrs(r[l]),i=r[l].children||[];i.length&&(n.values=fbUtils.parseOptions(r[l])),s.push(n)}return s},fbUtils.escapeHtml=function(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML},fbUtils.escapeAttr=function(e){function t(e){return a[e]||e}var a={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"};return"string"==typeof e?e.replace(/["&<>]/g,t):e},fbUtils.escapeAttrs=function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=fbUtils.escapeAttr(e[t]));return e},fbUtils.forEach=function(e,t,a){for(var s=0;s<e.length;s++)t.call(a,s,e[s])},fbUtils.unique=function(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})},fbUtils.fieldRender=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,s="",r="",l="",n=e.label||"",i=e.description||"",o="",p=e.values;e.name=a?e.name+"-preview":e.name,e.id=e.name,e.name=e.multiple?e.name+"[]":e.name,e.type=e.subtype||e.type,e.required&&(e.required=null,e["aria-required"]="true",o='<span class="required">*</span>'),"hidden"!==e.type&&(i&&(i='<span class="tooltip-element" tooltip="'+i+'">?</span>'),r='<label for="'+e.id+'" class="fb-'+e.type+'-label input-group-addon">'+n+" "+o+" "+i+"</label>");var d=e.label;delete e.label,delete e.description;var c=fbUtils.attrString(e);switch(e.type){case"textarea":case"rich-text":delete e.type;var u=e.value||"";s=r+"<textarea "+c+">"+u+"</textarea>",s='<div class="input-group">'+s+"</div>";break;case"select":var m;if(e.type=e.type.replace("-group",""),p){e.placeholder&&(l+="<option disabled selected>"+e.placeholder+"</option>");for(var f=0;f<p.length;f++)(!p[f].selected||e.placeholder)&&delete p[f].selected,p[f].label||(p[f].label=""),m=fbUtils.attrString(p[f]),l+="<option "+m+">"+p[f].label+"</option>"}s=r+"<select "+c+">"+l+"</select>",s='<div class="input-group">'+s+"</div>";break;case"checkbox-group":case"radio-group":var v=void 0;if(e.type=e.type.replace("-group",""),"checkbox"===e.type&&(e.name=e.name+"[]"),p){for(var h=void 0,g=0;g<p.length;g++)v=Object.assign({value:"",label:""},e,p[g]),v.selected&&(delete v.selected,v.checked=null),v.id=e.id+"-"+g,h=fbUtils.attrString(v),l+="<input "+h+' /> <label for="'+v.id+'">'+v.label+"</label>";if(e.other){var b={id:e.id+"-other",className:e.className+" other-option",onclick:"fbUtils.otherOptionCB('"+e.id+"-other')"};h=fbUtils.attrString(Object.assign({},e,b)),l+="<input "+h+' /> <label for="'+b.id+'">'+t.messages.other+'</label> <input type="text" name="'+e.name+'" id="'+b.id+'-value" style="display:none;" />'}}s=r+'<div class="'+e.type+'-group">'+l+"</div>";break;case"text":case"password":case"email":case"number":case"file":case"hidden":case"date":case"tel":case"autocomplete":s=r+" <input "+c+">","file"===e.type&&(s=r+'<div class="form-control" style="height: auto;"><div class="suredy-file"></div></div>'),"date"===e.type&&(s+='<div class="input-group-addon icon-calendar"></div>',s=s.replace(/type\="date"/,'type="text"')),s='<div class="input-group">'+s+"</div>";break;case"color":s=r+" <input "+c+"> "+t.messages.selectColor,s='<div class="input-group">'+s+"</div>";break;case"button":case"submit":s="<button "+c+">"+d+"</button>",s='<div class="input-group">'+s+"</div>";break;case"checkbox":s="<input "+c+"> "+r.replace(/input\-group\-addon/,""),e.toggle&&setTimeout(function(){$(document.getElementById(e.id)).kcToggle()},100);break;default:s="<"+e.type+" "+c+">"+d+"</"+e.type+">",s='<div class="input-group">'+s+"</div>"}if("hidden"!==e.type){var y=e.id?"fb-"+e.type+" form-group field-"+e.id:"";s=fbUtils.markup("div",s,{className:y})}else s=fbUtils.markup("input",null,e);return s},fbUtils.otherOptionCB=function(e){var t=document.getElementById(e),a=document.getElementById(e+"-value");t.checked?(t.style.display="none",a.style.display="inline-block"):(t.style.display="inline-block",a.style.display="none")},fbUtils.capitalize=function(e){return e.replace(/\b\w/g,function(e){return e.toUpperCase()})},function(e){var t=function(t,a){var s={theme:"fresh",messages:{off:"Off",on:"On"}},r=e.extend(s,a),l=e('<div class="kc-toggle"/>').insertAfter(t).append(t);l.toggleClass("on",t.is(":checked"));var n='<div class="kct-on">'+r.messages.on+"</div>",i='<div class="kct-off">'+r.messages.off+"</div>",o='<div class="kct-handle"></div>',p='<div class="kct-inner">'+n+o+i+"</div>";l.append(p),l.click(function(){t.attr("checked",!t.attr("checked")),e(this).toggleClass("on")})};e.fn.kcToggle=function(a){var s=this;return s.each(function(){var s=e(this);if(!s.data("kcToggle")){var r=new t(s,a);s.data("kcToggle",r)}})}}(jQuery),function(e){var t=function(t,a){function s(e,t){var a=[];for(var s in e)if(e.hasOwnProperty(s)){var n=p.messages[s],i=e[s].value;e[s].value=t[s]||e[s].value||"",e[s].label&&(p.messages[s]=e[s].label),a.push(e[s].options?l(s,e[s]):r(s,e[s])),p.messages[s]=n,e[s].value=i}return a.join("")}function r(e,t){var a={id:e+"-"+m,title:t.description||t.label||e.toUpperCase(),name:e,type:t.type||"text",className:["fld-"+e]},s='<label for="'+a.id+'">'+p.messages[e]+"</label>";o.inArray(a.type,["checkbox","checkbox-group","radio-group"])||a.className.push("form-control"),a=Object.assign({},t,a);var r="<input "+o.attrString(a)+">",l='<div class="input-wrap">'+r+"</div>";return'<div class="form-group '+e+'-wrap">'+s+l+"</div>"}function l(e,t){var a=Object.keys(t.options).map(function(e){var a={value:e};return e===t.value&&(a.selected=null),"<option "+o.attrString(a)+">"+t.options[e]+"</option>"}),s={id:e+"-"+m,title:t.description||t.label||e.toUpperCase(),name:e,className:"fld-"+e+" form-control"},r='<label for="'+s.id+'">'+p.messages[e]+"</label>";Object.keys(t).filter(function(e){return!o.inArray(e,["value","options","label"])}).forEach(function(e){s[e]=t[e]});var l="<select "+o.attrString(s)+">"+a.join("")+"</select>",n='<div class="input-wrap">'+l+"</div>";return'<div class="form-group '+e+'-wrap">'+r+n+"</div>"}var n=this,i={controlPosition:"right",controlOrder:["autocomplete","button","checkbox","checkbox-group","date","file","header","hidden","paragraph","number","radio-group","select","text","textarea"],dataType:"xml",disableFields:[],editOnAdd:!1,append:!1,prepend:!1,defaultFields:[],inputSets:[],fieldRemoveWarn:!1,roles:{1:"Administrator"},messages:{addOption:"Add Option +",allFieldsRemoved:"All fields were removed.",allowSelect:"Allow Select",allowMultipleFiles:"Allow users to upload multiple files",autocomplete:"Autocomplete",button:"Button",cannotBeEmpty:"This field cannot be empty",checkboxGroup:"Checkbox Group",checkbox:"Checkbox",checkboxes:"Checkboxes",className:"Class",clearAllMessage:"Are you sure you want to clear all fields?",clearAll:"Clear",close:"Close",content:"Content",copy:"Copy To Clipboard",copyButton:"&#43;",copyButtonTooltip:"Copy",dateField:"Date Field",description:"Help Text",descriptionField:"Description",devMode:"Developer Mode",editNames:"Edit Names",editorTitle:"Form Elements",editXML:"Edit XML",enableOther:"Enable &quot;Other&quot;",enableOtherMsg:"Let users to enter an unlisted option",fieldDeleteWarning:!1,fieldVars:"Field Variables",fieldNonEditable:"This field cannot be edited.",fieldRemoveWarning:"Are you sure you want to remove this field?",fileUpload:"File Upload",formUpdated:"Form Updated",getStarted:"Drag a field from the right to this area",header:"Header",hide:"Edit",hidden:"Hidden Input",label:"Label",labelEmpty:"Field Label cannot be empty",limitRole:"Limit access to one or more of the following roles:",mandatory:"Mandatory",maxlength:"Max Length",minOptionMessage:"This field requires a minimum of 2 options",multipleFiles:"Multiple Files",name:"Name",no:"No",number:"Number",off:"Off",on:"On",option:"Option",optional:"optional",optionLabelPlaceholder:"Label",optionValuePlaceholder:"Value",optionEmpty:"Option value required",other:"Other",paragraph:"Paragraph",placeholder:"Placeholder",placeholders:{value:"Value",label:"Label",text:"",textarea:"",email:"Enter you email",placeholder:"",className:"space separated classes",password:"Enter your password"},preview:"Preview",radioGroup:"Radio Group",radio:"Radio",removeMessage:"Remove Element",removeOption:"Remove Option",remove:"&#215;",required:"Required",richText:"Rich Text Editor",roles:"Access",save:"Save",selectOptions:"Options",select:"Select",selectColor:"Select Color",selectionsMessage:"Allow Multiple Selections",size:"Size",sizes:{xs:"Extra Small",sm:"Small",m:"Default",lg:"Large"},style:"Style",styles:{btn:{"default":"Default",danger:"Danger",info:"Info",primary:"Primary",success:"Success",warning:"Warning"}},subtype:"Type",text:"Text Field",textArea:"Text Area",toggle:"Toggle",warning:"Warning!",value:"Value",viewJSON:"{  }",viewXML:"&lt;/&gt;",yes:"Yes"},notify:{error:function(e){return console.error(e)},success:function(e){return console.log(e)},warning:function(e){return console.warn(e)}},sortableControls:!1,stickyControls:!1,showActionButtons:!0,typeUserAttrs:{},typeUserEvents:{},prefix:"form-builder-"},o=fbUtils;i.messages.subtypes=function(){var e=function(e){return{label:e,value:e}};return{text:["text","password"].map(e),header:["h1","h2","h3"].map(e),button:["button","submit","reset"].map(e),paragraph:["p","address","blockquote","canvas","output"].map(e)}}();var p=Object.assign({},i,t),d="frmb-"+e("ul[id^=frmb-]").length++;t.messages&&(p.messages=Object.assign({},i.messages,t.messages)),p.formID=d,n.element=a;var c=e("<ul/>").attr("id",d).addClass("frmb"),u=formBuilderHelpersFn(p,n);n.layout=u.editorLayout(p.controlPosition);var m=d+"-fld-1",f=d+"-control-box",v=[{label:p.messages.autocomplete,attrs:{type:"autocomplete",className:"autocomplete",name:"autocomplete"}},{label:p.messages.button,attrs:{type:"button",className:"button-input",name:"button"}},{label:p.messages.checkbox,attrs:{type:"checkbox",className:"checkbox",name:"checkbox",value:"on"}},{label:p.messages.checkboxGroup,attrs:{type:"checkbox-group",className:"checkbox-group",name:"checkbox-group"}},{label:p.messages.dateField,attrs:{type:"date",className:"calendar",name:"date-input"}},{label:p.messages.fileUpload,attrs:{type:"file",className:"file-input",name:"file-input"}},{label:p.messages.header,attrs:{type:"header",className:"header"}},{label:p.messages.hidden,attrs:{type:"hidden",className:"hidden-input",name:"hidden-input"}},{label:p.messages.number,attrs:{type:"number",className:"number",name:"number"}},{label:p.messages.paragraph,attrs:{type:"paragraph",className:"paragraph"}},{label:p.messages.radioGroup,attrs:{type:"radio-group",className:"radio-group",name:"radio-group"}},{label:p.messages.select,attrs:{type:"select",className:"select",name:"select"}},{label:p.messages.text,attrs:{type:"text",className:"text-input",name:"text-input"}},{label:p.messages.textArea,attrs:{type:"textarea",className:"text-area",name:"textarea",rows:"2"}}];v=u.orderFields(v),p.disableFields&&(v=v.filter(function(e){return!o.inArray(e.attrs.type,p.disableFields)}));var h=o.markup("ul",null,{id:f,className:"frmb-control"});p.sortableControls&&h.classList.add("sort-enabled");var g=e(h);o.forEach(v,function(t){var a=e("<li/>",{"class":"icon-"+v[t].attrs.className,type:v[t].type,name:v[t].className,label:v[t].label});a.data("newFieldData",v[t]);var s=o.markup("span",v[t].label);a.html(s).appendTo(g)}),p.inputSets.length&&(e("<li/>",{"class":"fb-separator"}).html("<hr>").appendTo(g),p.inputSets.forEach(function(t){t.name=t.name||u.makeClassName(t.label);var a=e("<li/>",{"class":"input-set-control",type:t.name});a.html(t.label).appendTo(g)})),c.sortable({cursor:"move",opacity:.9,revert:150,beforeStop:u.beforeStop,start:u.startMoving,stop:u.stopMoving,cancel:"input, select, .disabled, .form-group, .btn",placeholder:"frmb-placeholder"}),g.sortable({helper:"clone",opacity:.9,connectWith:c,cancel:".fb-separator",cursor:"move",scroll:!1,placeholder:"ui-state-highlight",start:u.startMoving,stop:u.stopMoving,revert:150,beforeStop:u.beforeStop,distance:3,update:function(e,t){return u.doCancel?!1:void(t.item.parent()[0]===c[0]?(b(t.item),u.doCancel=!0):(u.setFieldOrder(g),u.doCancel=!p.sortableControls))}});var b=function(e){if(e[0].classList.contains("input-set-control")){var t=p.inputSets.filter(function(t){return t.name===e[0].type})[0];if(t.showHeader){var a={type:"header",subtype:"h2",id:t.name,label:t.label};U(a,!0)}t.fields.forEach(function(e){U(e,!0)})}else U(e,!0)},y=e("<div/>",{id:d+"-form-wrap","class":"form-wrap form-builder"+u.mobileClass()}),w=e("<div/>",{id:d+"-stage-wrap","class":"stage-wrap "+n.layout.stage}),k=e("<div/>",{id:d+"-cb-wrap","class":"cb-wrap "+n.layout.controls}).append(g[0]);if(p.showActionButtons){var x="xml"===p.dataType?p.messages.viewXML:p.messages.viewJSON,C=o.markup("button",x,{id:d+"-view-data",type:"button",className:"view-data btn btn-default"}),E=o.markup("button",p.messages.clearAll,{id:d+"-clear-all",type:"button",className:"clear-all btn btn-default"}),A=o.markup("button",p.messages.save,{className:"btn btn-primary "+p.prefix+"save",id:d+"-save",type:"button"}),N=o.markup("div",[E,C,A],{className:"form-actions btn-group pull-right"});k.append(N)}w.append(c,k),w.before(y),y.append(w,k),e(a).append(y);var O=u.debounce(function(t){if(t&&"keyup"===t.type&&"className"===this.name)return!1;var a=e(this).parents(".form-field:eq(0)");u.updatePreview(a),u.save()});c.on("change blur keyup",".form-elements input, .form-elements select, .form-elements textarea",O),e("li",g).click(function(){u.stopIndex=void 0,b(e(this)),u.save()});var D=function(){var t=[];if(p.prepend&&!e(".disabled.prepend",c).length){var a=o.markup("li",p.prepend,{className:"disabled prepend"});t.push(!0),c.prepend(a)}if(p.append&&!e(".disabled.append",c).length){var s=o.markup("li",p.append,{className:"disabled append"});t.push(!0),c.append(s)}t.some(function(e){return e===!0})&&w.removeClass("empty")},U=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,s={};if(t instanceof jQuery){var r=t.data("newFieldData");if(r)s=r.attrs,s.label=r.label;else{var l=t[0].attributes;a||(s.values=t.children().map(function(t,a){return{label:e(a).text(),value:e(a).attr("value"),selected:Boolean(e(a).attr("selected"))}}));for(var i=l.length-1;i>=0;i--)s[l[i].name]=l[i].value}}else s=Object.assign({},t);s.name=a?T(s):s.name||T(s),s.className=a&&o.inArray(s.type,["text","number","file","date","select","textarea"])?"form-control":s.class||s.className;var p=/(?:^|\s)btn-(.*?)(?:\s|$)/g.exec(s.className);p&&(s.style=p[1]),o.escapeAttrs(s),L(s),a&&document.dispatchEvent(n.events.fieldAdded),w.removeClass("empty")},S=function(){var t=n.formData;if(t&&t.length){for(var a=0;a<t.length;a++)U(t[a]);w.removeClass("empty")}else p.defaultFields&&p.defaultFields.length?(p.defaultFields.forEach(function(e){return U(e)}),w.removeClass("empty")):p.prepend||p.append||w.addClass("empty").attr("data-content",p.messages.getStarted);u.save(),e("li.form-field:not(.disabled)",c).each(function(){u.updatePreview(e(this))}),D()};c.on("mousemove","li.disabled",function(t){e(".frmb-tt",this).css({left:t.offsetX-16,top:t.offsetY-34})}),c.on("mouseenter","li.disabled",function(){u.disabledTT.add(e(this))}),c.on("mouseleave","li.disabled",function(){u.disabledTT.remove(e(this))});
var T=function(e){var t=(new Date).getTime();return e.type+"-"+t},_=function W(e){var t=[o.markup("a",p.messages.addOption,{className:"add add-opt"})],W=['<label class="false-label">'+p.messages.selectOptions+"</label>"],a=e.multiple||"checkbox-group"===e.type;return e.values&&e.values.length?e.values.forEach(function(e){return Object.assign({},{selected:!1},e)}):(e.values=[1,2,3].map(function(e){var t=p.messages.option+" "+e,a={selected:!1,label:t,value:o.hyphenCase(t)};return a}),e.values[0].selected=!0),W.push('<div class="sortable-options-wrap">'),W.push('<ol class="sortable-options">'),o.forEach(e.values,function(t){W.push(H(e.name,e.values[t],a))}),W.push("</ol>"),W.push(o.markup("div",t,{className:"option-actions"}).outerHTML),W.push("</div>"),o.markup("div",W.join(""),{className:"form-group field-options"}).outerHTML},B=function X(e){var t,X=[],a=["select","checkbox-group","radio-group"],r=function(){return-1!==a.indexOf(e.type)}(),l=!o.inArray(e.type,["header","paragraph","file"].concat(a)),n=void 0!==e.role?e.role.split(","):[];if(X.push(q(e)),"checkbox"===e.type&&X.push(j("toggle",e,{first:p.messages.toggle})),X.push(I("label",e)),e.size=e.size||"m",e.style=e.style||"default",o.inArray(e.type,["header","paragraph","button"])||X.push(I("description",e)),p.messages.subtypes[e.type]){var i=p.messages.subtypes[e.type];X.push(M("subtype",e,i))}if("button"===e.type&&X.push($(e.style,e.type)),"number"===e.type&&(X.push(F("min",e)),X.push(F("max",e)),X.push(F("step",e))),X.push(I("placeholder",e)),"textarea"===e.type&&X.push(F("rows",e)),X.push(I("className",e)),X.push(I("name",e)),l&&X.push(I("value",e)),"file"===e.type){var d={first:p.messages.multipleFiles,second:p.messages.allowMultipleFiles};X.push(j("multiple",e,d))}var c=void 0!==e.role?'style="display:block"':"",u=['<div class="available-roles" '+c+">"];for(t in p.roles)if(p.roles.hasOwnProperty(t)){var f=o.inArray(t,n)?"checked":"",v="fld-"+m+"-roles-"+t;u.push('<input type="checkbox" name="roles[]" value="'+t+'" id="'+v+'" '+f+' class="roles-field" /> <label for="'+v+'">'+p.roles[t]+"</label><br/>")}u.push("</div>");var h={first:p.messages.roles,second:p.messages.limitRole,content:u.join("")};return X.push(j("access",e,h)),("checkbox-group"===e.type||"radio-group"===e.type)&&X.push(j("other",e,{first:p.messages.enableOther,second:p.messages.enableOtherMsg})),"select"===e.type&&X.push(j("multiple",e,{first:" ",second:p.messages.selectionsMessage})),r&&X.push(_(e)),o.inArray(e.type,["text","textarea"])&&X.push(F("maxlength",e)),p.typeUserAttrs[e.type]&&X.push(s(p.typeUserAttrs[e.type],e)),X.join("")},j=function(e,t,a){if(!p.typeUserAttrs[t.type]||!p.typeUserAttrs[t.type][e]){var s=function(t){return'<label for="'+e+"-"+m+'">'+t+"</label>"},r=void 0!==t[e]?"checked":"",l='<input type="checkbox" class="fld-'+e+'" name="'+e+'" value="true" '+r+' id="'+e+"-"+m+'"/> ',n=[],i=[l];return a.first&&n.unshift(s(a.first)),a.second&&i.push(s(a.second)),a.content&&i.push(a.content),i.unshift('<div class="input-wrap">'),i.push("</div>"),'<div class="form-group '+e+'-wrap">'+n.concat(i).join("")+"</div>"}},$=function(e,t){var a={button:"btn"},s=p.messages.styles[a[t]],r="";if(s){var l="<label>"+p.messages.style+"</label>";r+='<input value="'+e+'" name="style" type="hidden" class="btn-style">',r+='<div class="btn-group" role="group">',Object.keys(p.messages.styles[a[t]]).forEach(function(s){var l=e===s?"active":"";r+='<button value="'+s+'" type="'+t+'" class="'+l+" btn-xs "+a[t]+" "+a[t]+"-"+s+'">'+p.messages.styles[a[t]][s]+"</button>"}),r+="</div>",r='<div class="form-group style-wrap">'+l+" "+r+"</div>"}return r},F=function Y(e,t){if(!p.typeUserAttrs[t.type]||!p.typeUserAttrs[t.type][e]){var a=t[e],s=p.messages[e]||e,r=p.messages.placeholders[e],l={type:"number",value:a,name:e,min:"0",placeholder:r,className:"fld-"+e+" form-control",id:e+"-"+m},Y="<input "+o.attrString(o.trimObj(l))+">",n='<div class="input-wrap">'+Y+"</div>";return'<div class="form-group '+e+'-wrap"><label for="'+l.id+'">'+s+"</label> "+n+"</div>"}},M=function(e,t,a){if(!p.typeUserAttrs[t.type]||!p.typeUserAttrs[t.type][e]){var s=a.map(function(a,s){var r=Object.assign({label:p.messages.option+" "+s,value:void 0},a);return a.value===t[e]&&(r.selected=!0),"<option "+o.attrString(o.trimObj(r))+">"+r.label+"</option>"}),r={id:e+"-"+m,name:e,className:"fld-"+e+" form-control"},l='<label for="'+r.id+'">'+(p.messages[e]||o.capitalize(e))+"</label>",n="<select "+o.attrString(r)+">"+s.join("")+"</select>",i='<div class="input-wrap">'+n+"</div>";return'<div class="form-group '+r.name+'-wrap">'+l+i+"</div>"}},I=function(e,t){if(!p.typeUserAttrs[t.type]||!p.typeUserAttrs[t.type][e]){var a=["text","textarea","select"],s=["header"],r=["paragraph"],l=t[e]||"",n=p.messages[e];"label"===e&&o.inArray(t.type,r)&&(n=p.messages.content),s=s.concat(p.messages.subtypes.header,r);var i=p.messages.placeholders,d=i[e]||"",c="",u=[];if("placeholder"!==e||o.inArray(t.type,a)||u.push(!0),"name"===e&&o.inArray(t.type,s)&&u.push(!0),!u.some(function(e){return e===!0})){var f={name:e,placeholder:d,className:"fld-"+e+" form-control",id:e+"-"+m},v='<label for="'+f.id+'">'+n+"</label>";"label"===e&&o.inArray(t.type,r)||"value"===e&&"textarea"===t.type?c+="<textarea "+o.attrString(f)+">"+l+"</textarea>":(f.value=l,f.type="text",c+="<input "+o.attrString(f)+">");var h='<div class="input-wrap">'+c+"</div>";c='<div class="form-group '+e+'-wrap">'+v+" "+h+"</div>"}return c}},q=function(e){var t=["header","paragraph","button"],a=[],s="";return o.inArray(e.type,t)&&a.push(!0),a.some(function(e){return e===!0})||(s=j("required",e,{first:p.messages.required})),s},L=function(t){var a=t.type||"text",s=t.label||p.messages[a]||p.messages.label,r=o.markup("a",p.messages.remove,{id:"del_"+m,className:"del-button btn delete-confirm",title:p.messages.removeMessage}),l=o.markup("a",null,{id:m+"-edit",className:"toggle-form btn icon-pencil",title:p.messages.hide}),n=o.markup("a",p.messages.copyButton,{id:m+"-copy",className:"copy-button btn icon-copy",title:p.messages.copyButtonTooltip}),i=o.markup("div",[l,n,r],{className:"field-actions"}).outerHTML;i+='<label class="field-label">'+s+"</label>",t.description&&(i+='<span class="tooltip-element" tooltip="'+t.description+'">?</span>');var d=t.required?'style="display:inline"':"";i+='<span class="required-asterisk" '+d+"> *</span>",i+=o.markup("div","",{className:"prev-holder"}).outerHTML,i+='<div id="'+m+'-holder" class="frm-holder">',i+='<div class="form-elements">',i+=B(t),i+=o.markup("a",p.messages.close,{className:"close-field"}).outerHTML,i+="</div>",i+="</div>";var f=o.markup("li",i,{"class":a+"-field form-field "+t.colWidth,type:a,id:m}),v=e(f);v.data("fieldData",{attrs:t}),"undefined"!=typeof u.stopIndex?e("> li",c).eq(u.stopIndex).before(v):c.append(v),e(".sortable-options",v).sortable({update:function(){u.updatePreview(v)}}),u.updatePreview(v),p.editOnAdd&&(u.closeAllEdit(c),u.toggleEdit(m)),p.typeUserEvents[a]&&p.typeUserEvents[a].onadd&&p.typeUserEvents[a].onadd(f),m=u.incrementId(m)},H=function(e,t,a){var s={selected:a?"checkbox":"radio"},r=["value","label","selected"],l=[];t=Object.assign({selected:!1,label:"",value:""},t);for(var n=r.length-1;n>=0;n--){var i=r[n];if(t.hasOwnProperty(i)){var d={type:s[i]||"text","class":"option-"+i,value:t[i],name:e+"-option"};p.messages.placeholders[i]&&(d.placeholder=p.messages.placeholders[i]),"selected"===i&&t.selected===!0&&(d.checked=t.selected),l.push(o.markup("input",null,d))}}var c={className:"remove btn",title:p.messages.removeMessage};l.push(o.markup("a",p.messages.remove,c));var u=o.markup("li",l);return u.outerHTML},R=function(t){var a=t.attr("id"),s=t.attr("type"),r=(new Date).getTime(),l=s+"-"+r,n=t.clone();return n.find("[id]").each(function(){this.id=this.id.replace(a,m)}),n.find("[for]").each(function(){this.setAttribute("for",this.getAttribute("for").replace(a,m))}),n.each(function(){e("e:not(.form-elements)").each(function(){var e=this.getAttribute("name");e=e.substring(0,e.lastIndexOf("-")+1),e+=r.toString(),this.setAttribute("name",e)})}),n.find(".form-elements").find(":input").each(function(){if("name"===this.getAttribute("name")){var e=this.getAttribute("value");e=e.substring(0,e.lastIndexOf("-")+1),e+=r.toString(),this.setAttribute("value",e)}}),n.attr("id",m),n.attr("name",l),n.addClass("cloned"),e(".sortable-options",n).sortable(),p.typeUserEvents[s]&&p.typeUserEvents[s].onclone&&p.typeUserEvents[s].onclone(n[0]),m=u.incrementId(m),n};if(c.on("click touchstart",".remove",function(t){var a=e(this).parents(".form-field:eq(0)");t.preventDefault();var s=e(this).parents(".sortable-options:eq(0)").children("li").length;2>=s?p.notify.error("Error: "+p.messages.minOptionMessage):e(this).parent("li").slideUp("250",function(){e(this).remove(),u.updatePreview(a),u.save()})}),c.on("touchstart","input",function(t){if(t.handled===!0)return!1;if("checkbox"===e(this).attr("type"))e(this).trigger("click");else{e(this).focus();var a=e(this).val();e(this).val(a)}}),c.on("click touchstart",".toggle-form, .close-field",function(t){if(t.stopPropagation(),t.preventDefault(),t.handled===!0)return!1;var a=e(this).parents(".form-field:eq(0)").attr("id");u.closeAllEdit(c),u.toggleEdit(a),t.handled=!0}),c.on("change",".prev-holder input, .prev-holder select",function(t){if(!t.target.classList.contains("other-option")&&"file"!==t.target.type){var a=e(t.target).closest("li.form-field")[0];o.inArray(a.type,["select","checkbox-group","radio-group"])?a.querySelector('[class="option-value"][value="'+t.target.value+'"]').parentElement.childNodes[0].checked=!0:document.getElementById("value-"+a.id).value=t.target.value,u.save()}}),c.on("keyup change",'[name="colWidth"]',function(){e(this).closest("li").removeClass("full").removeClass("half").removeClass("small").removeClass("big-small").addClass(e(this).val())}),c.on("keyup change",'[name="label"]',function(){e(".field-label",e(this).closest("li")).text(e(this).val())}),c.delegate("input.error","keyup",function(){e(this).removeClass("error")}),c.on("keyup",'input[name="description"]',function(){var t=e(this).parents(".form-field:eq(0)"),a=e(".tooltip-element",t),s=e(this).val();if(""!==s)if(a.length)a.attr("tooltip",s).css("display","inline-block");else{var r='<span class="tooltip-element" tooltip="'+s+'">?</span>';e(".field-label",t).after(r)}else a.length&&a.css("display","none")}),c.on("change",".fld-multiple",function(t){var a=t.target.checked?"checkbox":"radio";e(t.target).parents(".form-elements:eq(0)").find(".sortable-options input.option-selected").each(function(){this.type=a})}),c.on("blur","input.fld-name",function(){this.value=u.safename(this.value),""===this.value?e(this).addClass("field-error").attr("placeholder",p.messages.cannotBeEmpty):e(this).removeClass("field-error")}),c.on("blur","input.fld-maxlength",function(){this.value=u.forceNumber(this.value)}),c.on("click touchstart",".icon-copy",function(t){t.preventDefault();var a=e(this).parent().parent("li"),s=R(a);s.insertAfter(a),u.updatePreview(s),u.save(),u.closeAllEdit(c),u.toggleEdit(s.attr("id"))}),c.on("click touchstart",".delete-confirm",function(t){t.preventDefault();var a=this.getBoundingClientRect(),s=document.body.getBoundingClientRect(),r={pageX:a.left+a.width/2,pageY:a.top-s.top-12},l=e(this).parents(".form-field:eq(0)").attr("id"),n=e(document.getElementById(l));if(document.addEventListener("modalClosed",function(){n.removeClass("deleting")},!1),p.fieldRemoveWarn){var i=o.markup("h3",p.messages.warning),d=o.markup("p",p.messages.fieldRemoveWarning);u.confirm([i,d],function(){return u.removeField(l)},r),n.addClass("deleting")}else u.removeField(l)}),c.on("click",".style-wrap button",function(){var t=e(this).val(),a=e(this).parent(),s=a.prev(".btn-style");s.val(t),e(this).siblings(".btn").removeClass("active"),e(this).addClass("active"),O.call(a)}),c.on("click","input.fld-required",function(){var t=e(this).parents("li.form-field").find(".required-asterisk");t.toggle()}),c.on("click","input.fld-access",function(){var t=e(this).parents("li.form-field").find("div.available-roles"),a=e(this);t.slideToggle(250,function(){a.is(":checked")||e('input[type="checkbox"]',t).removeAttr("checked")})}),c.on("click",".add-opt",function(t){t.preventDefault();var a=e(this).parents(".field-options:eq(0)"),s=e('[name="multiple"]',a),r=e(".option-selected:eq(0)",a),l=!1;l=s.length?s.prop("checked"):"checkbox"===r.attr("type");var n=r.attr("name");e(".sortable-options",a).append(H(n,!1,l))}),c.on("mouseover mouseout",".remove, .del-button",function(){e(this).parents("li:eq(0)").toggleClass("delete")}),p.showActionButtons){var P=e(document.getElementById(d+"-view-data"));P.click(function(e){e.preventDefault(),u.showData()});var z=e(document.getElementById(d+"-clear-all"));z.click(function(){var t=e("li.form-field"),a=this.getBoundingClientRect(),s=document.body.getBoundingClientRect(),r={pageX:a.left+a.width/2,pageY:a.top-s.top-12};t.length?u.confirm(p.messages.clearAllMessage,function(){u.removeAllfields(),p.notify.success(p.messages.allFieldsRemoved),u.save()},r):u.dialog("There are no fields to clear",{pageX:r.pageX,pageY:r.pageY})}),e(document.getElementById(d+"-save")).click(function(e){e.preventDefault(),u.save()})}return u.getData(),S(),c.css("min-height",g.height()),p.stickyControls&&u.stickyControls(c,h),document.dispatchEvent(n.events.loaded),n.actions={clearFields:u.removeAllfields,showData:u.showData,save:u.save,addField:function(e,t){u.stopIndex=c[0].children.length?t:void 0,U(e),document.dispatchEvent(n.events.fieldAdded)},removeField:u.removeField,setData:function(e){u.removeAllfields(),u.getData(e),S()},closeAllEdit:function(){u.closeAllEdit(c)}},n};e.fn.formBuilder=function(a){return a=a||{},this.each(function(){var s=new t(a,this);return e(this).data("formBuilder",s),s})}}(jQuery);